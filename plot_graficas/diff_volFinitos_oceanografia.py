import pandas
import numpy
import matplotlib.pyplot as plt

###########################################
#### Script utilizado para obtener el incremento \Delta n(x_{i},t^n) para uno de los casos de Oceanograf√≠a.
#### Utilizado para la obtencion de los resultados de la Figura 3.4 de la memoria del trabajo, en la cual
#### se visualiza una tendencia a un estado estacionario en las soluciones.
###########################################


datosVolFin='ficheros_simulaciones/OCEANOGRAFIA/vol_finitos/VOL-200_e-13mol_Z3_6m_EXPONENCIAL.txt'


data_Vol = pandas.read_csv(datosVolFin, sep=';',delimiter=';', skiprows=2, skipfooter=3, header=None)

data_Vol.to_numpy()


time=[0,300,600,900,1200,1500,1800,2100,2400,2700,3000,3300,3600,3900,4200,4500,4800,5100,5400,5700,6000,6300,6600,6900,7200,7500,7800,8100,8400,8700,9000,9300,9600,9900,10200,10500,10800,11100,11400,11700,12000,12300,12600,12900,13200,13500,13800,14100,14400,14700,15000,15300,15600,15900,16200,16500,16800,17100,17400,17700,18000,18300,18600,18900,19200,19500,19800,20100,20400,20700,21000,21300,21600,21900,22200,22500,22800,23100,23400,23700,24000,24300,24600,24900,25200,25500,25800,26100,26400,26700,27000,27300,27600,27900,28200,28500,42900,57300,71700,86100,100500,114900,129300,143700,158100,172500,186900,201300,215700,230100,244500,258900,273300,287700,302100,316500,330900,345300,359700,374100,388500,402900,417300,431700,446100,460500,474900,489300,503700,518100,532500,546900,561300,575700,590100,604500,618900,633300,647700,662100,676500,690900,705300,719700,734100,748500,762900,777300,791700,806100,820500,834900,849300,863700,878100,892500,906900,921300,935700,950100,964500,978900,993300,1007700,1022100,1036500,1050900,1065300,1079700,1094100,1108500,1122900,1137300,1151700,1166100,1180500,1194900,1209300,1223700,1238100,1252500,1266900,1281300,1295700,1310100,1324500,1338900,1353300,1367700,1382100,1396500,1410900,1425300,1439700,1454100,1468500,1482900,1497300,1511700,1526100,1540500,1554900,1569300,1583700,1598100,1612500,1626900,1641300,1655700,1670100,1684500,1698900,1713300,1727700,1742100,1756500,1770900,1785300,1799700,1814100,1828500,1842900,1857300,1871700,1886100,1900500,1914900,1929300,1943700,1958100,1972500,1986900,2001300,2015700,2030100,2044500,2058900,2073300,2087700,2102100,2116500,2130900,2145300,2159700,2174100,2188500,2202900,2217300,2231700,2246100,2260500,2274900,2289300,2303700,2318100,2332500,2346900,2361300,2375700,2390100,2404500,2418900,2433300,2447700,2462100,2476500,2490900,2505300,2519700,2534100,2548500,2562900,2577300,2591700,2606100,2620500,2634900,2649300,2663700,2678100,2692500,2706900,2721300,2735700,2750100,2764500,2778900,2793300,2807700,2822100,2836500,2850900,2865300,2879700,2894100,2908500,2922900,2937300,2951700,2966100,2980500,2994900,3009300,3023700,3038100,3052500,3066900,3081300,3095700,3110100,3124500,3138900,3153300,3167700,3182100,3196500,3210900,3225300,3239700,3254100,3268500,3282900,3297300,3311700,3326100,3340500,3354900,3369300,3383700,3398100,3412500,3426900,3441300,3455700,3470100,3484500,3498900,3513300,3527700,3542100,3556500,3570900,3585300,3599700,3614100,3628500,3642900,3657300,3671700,3686100,3700500,3714900,3729300,3743700,3758100,3772500,3786900,3801300,3815700,3830100,3844500,3858900,3873300,3887700,3902100,3916500,3930900,3945300,3959700,3974100,3988500,4002900,4017300,4031700,4046100,4060500,4074900,4089300,4103700,4118100,4132500,4146900,4161300,4175700,4190100,4204500,4218900,4233300,4247700,4262100,4276500,4290900,4305300,4319700,4334100,4348500,4362900,4377300,4391700,4406100,4420500,4434900,4449300,4463700,4478100,4492500,4506900,4521300,4535700,4550100,4564500,4578900,4593300,4607700,4622100,4636500,4650900,4665300,4679700,4694100,4708500,4722900,4737300,4751700,4766100,4780500,4794900,4809300,4823700,4838100,4852500,4866900,4881300,4895700,4910100,4924500,4938900,4953300,4967700,4982100,4996500,5010900,5025300,5039700,5054100,5068500,5082900,5097300,5111700,5126100,5140500,5154900,5169300,5183700,5198100,5212500,5226900,5241300,5255700,5270100,5284500,5298900,5313300,5327700,5342100,5356500,5370900,5385300,5399700,5414100,5428500,5442900,5457300,5471700,5486100,5500500,5514900,5529300,5543700,5558100,5572500,5586900,5601300,5615700,5630100,5644500,5658900,5673300,5687700,5702100,5716500,5730900,5745300,5759700,5774100,5788500,5802900,5817300,5831700,5846100,5860500,5874900,5889300,5903700,5918100,5932500,5946900,5961300,5975700,5990100,6004500,6018900,6033300,6047700,6062100,6076500,6090900,6105300,6119700,6134100,6148500,6162900,6177300,6191700,6206100,6220500,6234900,6249300,6263700,6278100,6292500,6306900,6321300,6335700,6350100,6364500,6378900,6393300,6407700,6422100,6436500,6450900,6465300,6479700,6494100,6508500,6522900,6537300,6551700,6566100,6580500,6594900,6609300,6623700,6638100,6652500,6666900,6681300,6695700,6710100,6724500,6738900,6753300,6767700,6782100,6796500,6810900,6825300,6839700,6854100,6868500,6882900,6897300,6911700,6926100,6940500,6954900,6969300,6983700,6998100,7012500,7026900,7041300,7055700,7070100,7084500,7098900,7113300,7127700,7142100,7156500,7170900,7185300,7199700,7214100,7228500,7242900,7257300,7271700,7286100,7300500,7314900,7329300,7343700,7358100,7372500,7386900,7401300,7415700,7430100,7444500,7458900,7473300,7487700,7502100,7516500,7530900,7545300,7559700,7574100,7588500,7602900,7617300,7631700,7646100,7660500,7674900,7689300,7703700,7718100,7732500,7746900,7761300,7775700,7790100,7804500,7818900,7833300,7847700,7862100,7876500,7890900,7905300,7919700,7934100,7948500,7962900,7977300,7991700,8006100,8020500,8034900,8049300,8063700,8078100,8092500,8106900,8121300,8135700,8150100,8164500,8178900,8193300,8207700,8222100,8236500,8250900,8265300,8279700,8294100,8308500,8322900,8337300,8351700,8366100,8380500,8394900,8409300,8423700,8438100,8452500,8466900,8481300,8495700,8510100,8524500,8538900,8553300,8567700,8582100,8596500,8610900,8625300,8639700,8654100,8668500,8682900,8697300,8711700,8726100,8740500,8754900,8769300,8783700,8798100,8812500,8826900,8841300,8855700,8870100,8884500,8898900,8913300,8927700,8942100,8956500,8970900,8985300,8999700,9014100,9028500,9042900,9057300,9071700,9086100,9100500,9114900,9129300,9143700,9158100,9172500,9186900,9201300,9215700,9230100,9244500,9258900,9273300,9287700,9302100,9316500,9330900,9345300,9359700,9374100,9388500,9402900,9417300,9431700,9446100,9460500,9474900,9489300,9503700,9518100,9532500,9546900,9561300,9575700,9590100,9604500,9618900,9633300,9647700,9662100,9676500,9690900,9705300,9719700,9734100,9748500,9762900,9777300,9791700,9806100,9820500,9834900,9849300,9863700,9878100,9892500,9906900,9921300,9935700,9950100,9964500,9978900,9993300,10007700,10022100,10036500,10050900,10065300,10079700,10094100,10108500,10122900,10137300,10151700,10166100,10180500,10194900,10209300,10223700,10238100,10252500,10266900,10281300,10295700,10310100,10324500,10338900,10353300,10367700,10382100,10396500,10410900,10425300,10439700,10454100,10468500,10482900,10497300,10511700,10526100,10540500,10554900,10569300,10583700,10598100,10612500,10626900,10641300,10655700,10670100,10684500,10698900,10713300,10727700,10742100,10756500,10770900,10785300,10799700,10814100,10828500,10842900,10857300,10871700,10886100,10900500,10914900,10929300,10943700,10958100,10972500,10986900,11001300,11015700,11030100,11044500,11058900,11073300,11087700,11102100,11116500,11130900,11145300,11159700,11174100,11188500,11202900,11217300,11231700,11246100,11260500,11274900,11289300,11303700,11318100,11332500,11346900,11361300,11375700,11390100,11404500,11418900,11433300,11447700,11462100,11476500,11490900,11505300,11519700,11534100,11548500,11562900,11577300,11591700,11606100,11620500,11634900,11649300,11663700,11678100,11692500,11706900,11721300,11735700,11750100,11764500,11778900,11793300,11807700,11822100,11836500,11850900,11865300,11879700,11894100,11908500,11922900,11937300,11951700,11966100,11980500,11994900,12009300,12023700,12038100,12052500,12066900,12081300,12095700,12110100,12124500,12138900,12153300,12167700,12182100,12196500,12210900,12225300,12239700,12254100,12268500,12282900,12297300,12311700,12326100,12340500,12354900,12369300,12383700,12398100,12412500,12426900,12441300,12455700,12470100,12484500,12498900,12513300,12527700,12542100,12556500,12570900,12585300,12599700,12614100,12628500,12642900,12657300,12671700,12686100,12700500,12714900,12729300,12743700,12758100,12772500,12786900,12801300,12815700,12830100,12844500,12858900,12873300,12887700,12902100,12916500,12930900,12945300,12959700,12974100,12988500,13002900,13017300,13031700,13046100,13060500,13074900,13089300,13103700,13118100,13132500,13146900,13161300,13175700,13190100,13204500,13218900,13233300,13247700,13262100,13276500,13290900,13305300,13319700,13334100,13348500,13362900,13377300,13391700,13406100,13420500,13434900,13449300,13463700,13478100,13492500,13506900,13521300,13535700,13550100,13564500,13578900,13593300,13607700,13622100,13636500,13650900,13665300,13679700,13694100,13708500,13722900,13737300,13751700,13766100,13780500,13794900,13809300,13823700,13838100,13852500,13866900,13881300,13895700,13910100,13924500,13938900,13953300,13967700,13982100,13996500,14010900,14025300,14039700,14054100,14068500,14082900,14097300,14111700,14126100,14140500,14154900,14169300,14183700,14198100,14212500,14226900,14241300,14255700,14270100,14284500,14298900,14313300,14327700,14342100,14356500,14370900,14385300,14399700,14414100,14428500,14442900,14457300,14471700,14486100,14500500,14514900,14529300,14543700,14558100,14572500,14586900,14601300,14615700,14630100,14644500,14658900,14673300,14687700,14702100,14716500,14730900,14745300,14759700,14774100,14788500,14802900,14817300,14831700,14846100,14860500,14874900,14889300,14903700,14918100,14932500,14946900,14961300,14975700,14990100,15004500,15018900,15033300,15047700,15062100,15076500,15090900,15105300,15119700,15134100,15148500,15162900,15177300,15191700,15206100,15220500,15234900,15249300,15263700,15278100,15292500,15306900,15321300,15335700,15350100,15364500,15378900,15393300,15407700,15422100,15436500,15450900,15465300,15479700,15494100,15508500,15522900,15537300,15551700,15566100,15580500]

nMean=numpy.zeros(len(time))
nStddev=numpy.zeros(len(time))

#print(data_Vol)

n=200
diff=numpy.zeros(n)
for i in range(0,len(nMean)):
    for j in range(10,n):
        try:
            if i+1<len(nMean):
                diff[j]=numpy.abs(data_Vol[j][i+1]-data_Vol[j][i])/((time[i+1]-time[i]))
            else:
                diff[j]=numpy.abs(data_Vol[j][i+1]-data_Vol[j][i])/((time[i]-time[i-1]))
        except:
            print('Error: ')

    nMean[i]=numpy.mean(diff)
    nStddev[i]=numpy.std(diff)


for i in range(0,len(time)):
    time[i]=time[i]/86400

plt.figure(1)

plt.plot(time,nMean, label='$\mu$')
plt.plot(time,nStddev, 'g', label='$\sigma$')
plt.title('n(x,t$_{0}$)=$6.023\cdot 10^{10}$(x$_{0}$/x)$^{1/5}$ POC/m$^{3}$')
plt.ylabel('')
plt.xlabel('t (d√≠as)')
plt.legend()


plt.show()